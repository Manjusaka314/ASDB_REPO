import{p as s,i,G as o,z as e,o as t,c as n,a,F as l,E as r,t as c,d,b as p,r as m,h as _,f as h,g as v}from"./index.c0e2940b.js";import"./@pixi.ba7a7c6f.js";const w={inject:["socket","format"],props:{mission:Object},data:()=>({itemsCol:void 0,itemsRow:void 0,nowWave:0,trapWave:0,defaultBoard:[[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1]],showMons:!0,showTrap:!0,showColor:!1}),mounted(){$(".el-switch__label").css("color","white");let s=this;o(e((()=>s.mission?{subtitle:s.mission.waypoint?s.mission.waypoint+" "+s.mission.title:s.mission.title}:{}))),$(".tippy").each((function(s,i){tippy(i.children[1],{content:i.children[0],arrow:!0})}));window.innerWidth>768?(this.itemsCol="2",this.itemsRow="3"):(this.itemsCol="3",this.itemsRow="1");const i=this.mission.born_pos;$("#"+i[0]+"-"+i[1]).addClass("born_cell");var t,n=this.mission.waves[this.nowWave].monster;for(t in n){2091411==n[t].monster_id&&(n[t].position=[4,8]);var a=n[t].position[0]+"-"+n[t].position[1];let s,i=n[t].area;for(s in i){var l=n[t].position[0]+i[s][0]+"-"+(n[t].position[1]+i[s][1]);$("#"+l).addClass("monster_cell"),$("#"+l).addClass("monster_"+a)}}var r,c=this.mission.waves[this.nowWave].trap;for(r in c){var d=c[r].position[0]+"-"+c[r].position[1];let s,i=c[r].area;for(s in i){var p=c[r].position[0]+i[s][0]+"-"+(c[r].position[1]+i[s][1]);$("#"+p).addClass("trap_cell"),$("#"+p).addClass("trap_"+d),$("#"+p).addClass("wave_"+(this.nowWave+1))}}var m,_=this.mission.board.gap;for(m in _)$("#"+_[m][0]+"-"+_[m][1]).addClass("type_0");0==this.nowWave&&$("#prev").attr("style","opacity: 0.4; pointer-events: none"),1==this.mission.waves.length&&$("#next").attr("style","opacity: 0.4; pointer-events: none");var h,v=this.mission.board.specified_board?this.mission.board.specified_board:this.defaultBoard;for(h in v){var w;for(w in v[h])$("#"+(Number(h)+1)+"-"+(Number(w)+1)).addClass("type_"+v[h][w])}},methods:{calcItemIconPath:s=>s?"/comm_icon/"+s.icon+".png":"/comm_icon/toptoon_3000001.png",reInitPage(s,i){this.$router.push("/Mission/"+i+"/"+s)},calcStatus:s=>s.formula?"WIP":s[0],cellWidth(s){var i;return i=window.innerWidth>768?2:s,$("#map").width()/s-i},monsterHeight:()=>.7*($("#map").width()-120),trapHeight:()=>.3*($("#map").width()-120),showCellInfo(s){if($(".trap_name, .trap_desc").css("display","none"),$(".trap_cell").css("filter","unset"),$(".trap_cell").removeClass("is_bright"),$(event.target).hasClass("trap_cell")){const i=$(event.target).attr("class"),o=i.match(/trap_[0-9]{1,2}-[0-9]{1,2}/g)[0],e=i.match(/wave_[0-9]{1,2}/g).slice(-1)[0];$("."+o+"."+e).css("filter","brightness(1.5)"),$("."+o+"."+e).addClass("is_bright"),$(".trap_tips").css("display","none"),$('span[data-area*="'+s+'"][data-wave*="'+e+'"]').css("display","block")}else $(".trap_tips").css("display","block")},showMonsPos(s){$('div[class*="monster_'+s+'"]').css("filter","brightness(1.5)")},hideMonsPos(s){$('div[class*="monster_'+s+'"]:not(.is_bright)').css("filter","none")},prevWave(){$(".monster_cell").removeClass("monster_cell"),$('[class*="monster_"]').removeClass((function(s,i){return(i.match(/\bmonster_[0-9]{1,2}\S+/g)||[]).join(" ")})),$(".trap_cell").css("filter","none"),$(".trap_cell").removeClass("is_bright");var s,i=this.mission.waves[this.nowWave].trap;for(s in i){var o=i[s].position[0]+"-"+i[s].position[1];let t,n=i[s].area;for(t in n){var e=i[s].position[0]+n[t][0]+"-"+(i[s].position[1]+n[t][1]);let a=this.nowWave;for(;a>0;)$("#"+e).hasClass("wave_"+a)||($("#"+e).removeClass("trap_"+o),$("#"+e).removeClass("trap_cell")),a--;$("#"+e).removeClass("wave_"+(this.nowWave+1))}}if(this.nowWave=this.nowWave-1,$("#next").removeAttr("style"),0==this.nowWave){$("#prev").attr("style","opacity: 0.4; pointer-events: none");const s=this.mission.born_pos;$("#"+s[0]+"-"+s[1]).addClass("born_cell")}var t,n=this.mission.waves[this.nowWave].monster;for(t in n){var a=n[t].position[0]+"-"+n[t].position[1];let s,i=n[t].area;for(s in i){var l=n[t].position[0]+i[s][0]+"-"+(n[t].position[1]+i[s][1]);$("#"+l).addClass("monster_cell"),$("#"+l).addClass("monster_"+a)}}$(".mons_scroll .el-scrollbar__wrap").scrollTop(0)},nextWave(){$(".born_cell").removeClass("born_cell"),$(".monster_cell").removeClass("monster_cell"),$('[class*="monster_"]').removeClass((function(s,i){return(i.match(/\bmonster_[0-9]{1,2}\S+/g)||[]).join(" ")})),$(".trap_cell").css("filter","none"),$(".trap_cell").removeClass("is_bright"),this.nowWave=this.nowWave+1,$("#prev").removeAttr("style"),this.nowWave+1==this.mission.waves.length&&$("#next").attr("style","opacity: 0.4; pointer-events: none");var s,i=this.mission.waves[this.nowWave].monster;for(s in console.log(i),i){var o=i[s].position[0]+"-"+i[s].position[1];let t,n=i[s].area;for(t in n){var e=i[s].position[0]+n[t][0]+"-"+(i[s].position[1]+n[t][1]);$("#"+e).addClass("monster_cell"),$("#"+e).addClass("monster_"+o)}}var t,n=this.mission.waves[this.nowWave].trap;for(t in n){var a=n[t].position[0]+"-"+n[t].position[1];let s,i=n[t].area;for(s in i){var l=n[t].position[0]+i[s][0]+"-"+(n[t].position[1]+i[s][1]);$("#"+l).addClass("trap_cell"),$("#"+l).addClass("trap_"+a),$("#"+l).addClass("wave_"+(this.nowWave+1))}}$(".mons_scroll .el-scrollbar__wrap").scrollTop(0)},calcTrapArea(s,i){var o,e=this.mission.waves[s].trap[i],t=e.area,n=[];for(o in t){var a=e.position[0]+t[o][0]+"-"+(e.position[1]+t[o][1]);n.push(a)}return n},toggleMons(){this.showMons?($(".monster_cell").removeClass("monster_hide"),$(".mons_icon").css("pointer-events","unset")):($(".monster_cell").addClass("monster_hide"),$(".mons_icon").css("pointer-events","none"))},toggleTrap(){$(".trap_name, .trap_desc").css("display","none"),$(".trap_tips").css("display","block"),this.showTrap?$(".trap_cell").removeClass("trap_hide"):($(".trap_cell").css("filter","none"),$(".trap_cell").removeClass("is_bright"),$(".trap_cell").addClass("trap_hide"))},toggleColor(){this.showColor?$('[class*="type_1"],[class*="type_2"],[class*="type_3"],[class*="type_4"]').removeClass("color_hide"):$('[class*="type_1"],[class*="type_2"],[class*="type_3"],[class*="type_4"]').addClass("color_hide")}}},u=_("data-v-d806d8dc");s("data-v-d806d8dc");const y={key:0},f={class:"mission_info"},g={class:"need_power nomobile",style:{width:"150px"}},b={width:"30"},k={colspan:"3",style:{width:"850px","vertical-align":"middle"}},C=a("i",{class:"fas fa-unlock"},null,-1),x=r(" , "),M={key:0,class:"nodesktop"},W={class:"need_power"},T={width:"30"},I={key:1},P={class:"nomobile"},H={colspan:"3"},V={key:2},L={class:"nomobile"},j={colspan:"3"},N={key:3},R=a("i",{class:"fas fa-stopwatch"},null,-1),S={colspan:"3"},A=a("hr",null,null,-1),z={width:"64",height:"64"},U=a("hr",null,null,-1),D={key:0},O={key:1,style:{color:"yellow","font-size":"smaller"}},B={key:4,class:"nodesktop"},E={key:5},F={key:6},G={colspan:"4"},q={colspan:"3"},J={key:8},K={class:"board",colspan:"4"},Q={class:"map"},X={class:"refresh"},Y={class:"check_box"},Z={class:"switch"},ss={class:"switch"},is={class:"switch"},os={class:"wave_select"},es={colspan:"4",class:"mons_name",style:{"padding-bottom":"4px"}},ts={width:"20"},ns={key:0,class:"tippy",style:{position:"relative"}},as={style:{"font-weight":"bold",display:"inline-block","margin-bottom":"2px"}},ls=a("br",null,null,-1),rs={width:"20"},cs={key:0,style:{position:"absolute",bottom:"-5px",right:"0","font-size":"8pt"}},ds={width:"80"},ps={style:{width:"33.33%"}},ms={style:{width:"33.33%"}},_s={style:{width:"33.33%"}},hs={style:{width:"33.33%"}},vs={style:{color:"yellow"}},ws={style:{width:"33.33%"}},us={style:{color:"yellow"}},ys={style:{width:"33.33%"}},fs={style:{color:"yellow"}},gs={style:{color:"yellow"}},$s={style:{color:"yellow"}},bs={style:{color:"yellow"}},ks={class:"round_select"},Cs=a("i",{id:"prevRound",class:"fas fa-caret-left"},null,-1),xs=a("i",{id:"nextRound",class:"fas fa-caret-right"},null,-1),Ms={class:"trap"},Ws={style:{"margin-left":"5px","font-weight":"bold"}},Ts={class:"trap_tips"},Is=a("br",null,null,-1);i();const Ps=u(((s,i,o,e,_,w)=>{const $=h("el-scrollbar"),Ps=h("el-switch"),Hs=v("lazy");return t(),n(l,null,[a("h1",null,[o.mission.waypoint?(t(),n(l,{key:0},[r(c(o.mission.waypoint)+" "+c(o.mission.title),1)],64)):(t(),n(l,{key:1},[r(c(o.mission.title),1)],64))]),3!=o.mission.type?(t(),n("p",y,c(o.mission.desc),1)):d("",!0),a("table",f,[a("tr",null,[a("td",g,[p(a("img",b,null,512),[[Hs,w.calcItemIconPath(o.mission.need_ap)]]),a("span",null,c(o.mission.need_ap?o.mission.need_ap.count:o.mission.need_power),1)]),a("td",k,[C,r(" "+c(s.$t("mission.need_level"))+" "+c(o.mission.need_level)+" ",1),o.mission.need_mission_list.length>0?(t(),n(l,{key:0},[r(c(s.$t("mission.need_mission.prefix"))+" ",1),(t(!0),n(l,null,m(o.mission.need_mission_list,((i,o)=>(t(),n(l,{key:o},[o>0?(t(),n(l,{key:0},[x],64)):d("",!0),r(c(s.$t("mission.need_mission.missions["+(i.type-1)+"]"))+" ",1),a("a",{class:"need_mission",style:{cursor:"pointer"},onClick:s=>w.reInitPage(i.id,i.type)},c(i.name),9,["onClick"])],64)))),128))],64)):d("",!0)])]),3!=o.mission.type?(t(),n("tr",M,[a("td",W,[p(a("img",T,null,512),[[Hs,w.calcItemIconPath(o.mission.need_ap)]]),a("span",null,c(o.mission.need_ap?o.mission.need_ap.count:o.mission.need_power),1)]),a("td",null,[a("i",{class:"far fa-"+(o.mission.auto_fight?"check":"times")+"-circle"},null,2),r(" "+c(s.$t("mission.auto_fight")),1)]),a("td",null,[a("i",{class:"far fa-"+(o.mission.auto_fight?"check":"times")+"-circle"},null,2),r(" "+c(s.$t("mission.help_pet")),1)])])):d("",!0),3!=o.mission.type?(t(),n("tr",I,[a("td",P,[a("i",{class:"far fa-"+(o.mission.auto_fight?"check":"times")+"-circle"},null,2),r(" "+c(s.$t("mission.auto_fight")),1)]),a("td",H,c(s.$t("mission.recommend"))+" "+c(o.mission.recommend_awaken>0?s.$t("mission.awaken")+o.mission.recommend_awaken:"")+" LV."+c(o.mission.recommend_lv),1)])):d("",!0),3!=o.mission.type?(t(),n("tr",V,[a("td",L,[a("i",{class:"far fa-"+(o.mission.auto_fight?"check":"times")+"-circle"},null,2),r(" "+c(s.$t("mission.help_pet")),1)]),a("td",j,c(s.$t("mission.complete_condition"))+c(o.mission.complete_condition),1)])):d("",!0),3!=o.mission.type?(t(),n("tr",N,[a("td",null,[R,r(" "+c(o.mission.round),1)]),a("td",S,c(s.$t("mission.chang_count"))+c(-1==o.mission.chang_count?"∞":o.mission.chang_count),1)])):d("",!0),a("tr",null,[o.mission.star_3_condition&&3!=o.mission.type?(t(),n("td",{key:0,class:"nomobile",colspan:"2",style:{"min-width":"300px"},innerHTML:"<i class='fas fa-star'></i> "+w.format(o.mission.star_3_condition[0])},null,8,["innerHTML"])):d("",!0),a("td",{colspan:o.mission.star_3_condition?_.itemsCol:"4",rowspan:o.mission.star_3_condition?_.itemsRow:"1",style:{padding:"1px 0"}},[a($,{"view-style":"display: flex; width: 340px"},{default:u((()=>[(t(!0),n(l,null,m(Object.keys(o.mission.drop_config),(i=>(t(),n(l,{key:i},[o.mission.drop_config[i]?(t(!0),n(l,{key:0},m(o.mission.drop[i],(o=>(t(),n("div",{key:i+o.name,class:"drop_item"},[r(c(s.$t("mission.drop."+i))+" ",1),A,p(a("img",z,null,512),[[Hs,"/item_icon/"+o.icon+"_scale.png"]]),U,o.count?(t(),n("span",D,c(o.count),1)):d("",!0),o.rarity?(t(),n("span",O,c(o.rarity),1)):d("",!0)])))),128)):d("",!0)],64)))),128))])),_:1})],8,["colspan","rowspan"])]),o.mission.star_3_condition&&3!=o.mission.type?(t(),n("tr",B,[a("td",{colspan:"3",innerHTML:"<i class='fas fa-star'></i> "+w.format(o.mission.star_3_condition[0])},null,8,["innerHTML"])])):d("",!0),o.mission.star_3_condition&&3!=o.mission.type?(t(),n("tr",E,[a("td",{colspan:_.itemsCol,innerHTML:"<i class='fas fa-star'></i> "+w.format(o.mission.star_3_condition[1])},null,8,["colspan","innerHTML"])])):d("",!0),o.mission.star_3_condition&&3!=o.mission.type?(t(),n("tr",F,[a("td",{colspan:_.itemsCol,innerHTML:"<i class='fas fa-star'></i> "+w.format(o.mission.star_3_condition[2])},null,8,["colspan","innerHTML"])])):d("",!0),o.mission.base_word_buff&&3!=o.mission.type?(t(),n(l,{key:7},[a("tr",null,[a("th",G,c(s.$t("mission.base_word_buff")),1)]),(t(!0),n(l,null,m(o.mission.base_word_buff,((s,i)=>(t(),n("tr",{key:i},[a("td",null,c(i),1),a("td",q,c(s),1)])))),128))],64)):d("",!0),3!=o.mission.type?(t(),n("tr",J,[a("td",K,[a("div",Q,[a("div",{id:"map",class:o.mission.board.mode>0?"fixed_mode":""},[(t(),n(l,null,m(11,(s=>a("div",{key:s},[(t(),n(l,null,m(11,(i=>a("div",{id:s-1+"-"+(i-1),key:i,class:"cell",style:"width:"+w.cellWidth(11)+"px; height:"+w.cellWidth(11)+"px",onClick:o=>w.showCellInfo(s-1+"-"+(i-1))}," ",12,["id","onClick"]))),64))]))),64))],2)]),a("div",X,[a("div",Y,[a("div",Z,[a(Ps,{modelValue:_.showMons,"onUpdate:modelValue":i[1]||(i[1]=s=>_.showMons=s),"active-color":"yellowgreen","active-text":s.$i18n.t("mission.show_monster"),change:w.toggleMons()},null,8,["modelValue","active-text","change"])]),a("div",ss,[a(Ps,{modelValue:_.showTrap,"onUpdate:modelValue":i[2]||(i[2]=s=>_.showTrap=s),"active-color":"yellowgreen","active-text":s.$i18n.t("mission.show_trap"),change:w.toggleTrap()},null,8,["modelValue","active-text","change"])]),a("div",is,[a(Ps,{modelValue:_.showColor,"onUpdate:modelValue":i[3]||(i[3]=s=>_.showColor=s),"active-color":"yellowgreen",disabled:!o.mission.board.specified_board,"active-text":s.$i18n.t("mission.show_color"),change:w.toggleColor()},null,8,["modelValue","disabled","active-text","change"])])]),a("div",os,[a("i",{id:"prev",class:"fas fa-caret-left",onClick:i[4]||(i[4]=s=>w.prevWave())}),r(" WAVE "+c(_.nowWave+1)+" / "+c(o.mission.waves.length)+" ",1),a("i",{id:"next",class:"fas fa-caret-right",onClick:i[5]||(i[5]=s=>w.nextWave())})]),a($,{class:"mons_scroll","wrap-style":"border: 1px solid; height: "+w.monsterHeight()+"px"},{default:u((()=>[(t(!0),n(l,null,m(o.mission.waves[_.nowWave].monster,(i=>(t(),n("table",{key:i.index,class:"monster"},[a("tr",null,[a("td",es,[p(a("img",ts,null,512),[[Hs,"/element_icon/element_"+i.element+".png"]]),a("span",null," "+c(i.name)+" ",1),(t(!0),n(l,null,m(i.buff_list,(s=>(t(),n(l,{key:s.index},[s.icon?(t(),n("span",ns,[a("span",null,[a("span",as,c(s.name),1),ls,r(c(s.desc),1)]),p(a("img",rs,null,512),[[Hs,"/icon_buff/"+s.icon+"_scale.png"]]),s.layer?(t(),n("span",cs,c(s.layer),1)):d("",!0)])):d("",!0)],64)))),128))])]),a("tr",null,[a("td",{class:"mons_icon",rowspan:"4",onMouseenter:s=>w.showMonsPos(i.position[0]+"-"+i.position[1]),onMouseleave:s=>w.hideMonsPos(i.position[0]+"-"+i.position[1])},[p(a("img",ds,null,512),[[Hs,"/monster_icon/"+i.icon+"_scale.png"]])],40,["onMouseenter","onMouseleave"]),a("td",ps,c(s.$t("mission.atk")),1),a("td",ms,c(s.$t("mission.def")),1),a("td",_s,c(s.$t("mission.hp")),1)]),a("tr",null,[a("td",hs,[a("span",vs,c(w.calcStatus(i.atk)),1)]),a("td",ws,[a("span",us,c(w.calcStatus(i.def)),1)]),a("td",ys,[a("span",fs,c(w.calcStatus(i.hp)),1)])]),a("tr",null,[a("td",null,c(s.$t("mission.absorb_normal")),1),a("td",null,c(s.$t("mission.absorb_chain")),1),a("td",null,c(s.$t("mission.absorb_active")),1)]),a("tr",null,[a("td",null,[a("span",gs,c(i.anormal),1)]),a("td",null,[a("span",$s,c(i.achain),1)]),a("td",null,[a("span",bs,c(i.active),1)])])])))),128))])),_:1},8,["wrap-style"]),a("div",ks,[Cs,r(" ROUND 0 / "+c(o.mission.round)+" ",1),xs]),a("div",Ms,[a("span",Ws,c(s.$t("mission.trap")),1)]),a("div",{class:"trap_info",style:"height:"+w.trapHeight()+"px"},[a("span",Ts,c(s.$t("mission.trap_tips")),1),(t(!0),n(l,null,m(o.mission.waves,((s,i)=>(t(),n(l,{key:i},[(t(!0),n(l,null,m(s.trap,((s,o)=>(t(),n(l,{key:s.index},[a("span",{id:"trapname_"+s.position[0]+"-"+s.position[1],class:"trap_name","data-area":w.calcTrapArea(i,o),"data-wave":"wave_"+(i+1)},[r(c(s.name),1),Is],8,["id","data-area","data-wave"]),a("span",{id:"trapdesc_"+s.position[0]+"-"+s.position[1],class:"trap_desc","data-area":w.calcTrapArea(i,o),"data-wave":"wave_"+(i+1)},c(s.desc),9,["id","data-area","data-wave"])],64)))),128))],64)))),128))],4)])])])):d("",!0)])],64)}));w.render=Ps,w.__scopeId="data-v-d806d8dc";const Hs={components:{MissionData:w},inject:["socket","format"],data:()=>({mission:void 0,loadingNewMap:!0}),watch:{$route(s){this.loadingNewMap=!0,this.initMissionPage(s.params.missionId,parseInt(s.params.missionType))}},mounted(){this.initMissionPage(this.$route.params.missionId,parseInt(this.$route.params.missionType))},methods:{initMissionPage(s,i){let o=this;const e=localStorage.getItem("game_lang");this.socket.emit("get_mission_info",[s,e,i],(function(s){o.loadingNewMap=!1,o.mission=s}))}}};Hs.render=function(s,i,o,e,a,l){const r=h("MissionData");return a.mission&&!a.loadingNewMap?(t(),n(r,{key:0,mission:a.mission},null,8,["mission"])):d("",!0)};export default Hs;
